"use strict";let userCard={name:"",job:"",phone:"",email:"",linkedin:"",github:"",photo:"",palette:1};const inputPhone=document.querySelector("#phone"),previewPhone=document.querySelector(".phone__icon");function writePhone(e){e.currentTarget,userCard.phone=inputPhone.value,saveCache(),inputPhone.value?(previewPhone.href="tel:"+inputPhone.value,previewPhone.classList.remove("hide")):previewPhone.classList.add("hide")}inputPhone.addEventListener("keyup",writePhone);const previewName=document.querySelector(".name"),inputName=document.querySelector("#name"),previewJob=document.querySelector(".job"),inputJob=document.querySelector("#position");function writeName(e){e.currentTarget,previewName.innerHTML=inputName.value||"Nombre Apellido",userCard.name=inputName.value,saveCache()}function writePosition(e){e.currentTarget,previewJob.innerHTML=inputJob.value||"Front-end developer",userCard.job=inputJob.value,saveCache()}inputName.addEventListener("keyup",writeName),inputJob.addEventListener("keyup",writePosition);const inputGithub=document.getElementById("github"),previewGithub=document.querySelector(".github");function writeGithub(e){e.currentTarget;const t=inputGithub.value;userCard.github=inputGithub.value,saveCache(),t?(previewGithub.classList.remove("hide"),previewGithub.href=t):previewGithub.classList.add("hide")}inputGithub.addEventListener("keyup",writeGithub);const inputMail=document.getElementById("email");function writeMail(e){e.currentTarget;const t=inputMail.value;userCard.email=inputMail.value,saveCache();const r=document.querySelector(".buttonMail");t?(r.classList.remove("hide"),r.href=`mailto:${t}`):r.classList.add("hide"),console.log(userCard)}inputMail.addEventListener("keyup",writeMail);const inputLinkedin=document.getElementById("Linkedin");function writeLinkedin(){const e=document.querySelector(".linkedin");userCard.linkedin=inputLinkedin.value,saveCache(),inputLinkedin.value?(e.classList.remove("hide"),e.href=inputLinkedin.value):e.classList.add("hide")}inputLinkedin.addEventListener("keyup",writeLinkedin);const cardContainerEl=document.querySelector(".section__preview"),themeGreenEl=document.getElementById("theme-green"),themeRedEl=document.getElementById("theme-red"),themeGreyEl=document.getElementById("theme-grey");function handlerChangeTheme(){themeRedEl.checked?(userCard.palette=parseInt(themeRedEl.value),cardContainerEl.classList.add("theme--red"),cardContainerEl.classList.remove("theme--grey")):themeGreyEl.checked?(userCard.palette=parseInt(themeGreyEl.value),cardContainerEl.classList.add("theme--grey"),cardContainerEl.classList.remove("theme--red")):(userCard.palette=parseInt(themeGreenEl.value),cardContainerEl.classList.remove("theme--grey","theme--red")),saveCache()}themeGreenEl.addEventListener("click",handlerChangeTheme),themeRedEl.addEventListener("click",handlerChangeTheme),themeGreyEl.addEventListener("click",handlerChangeTheme);const tabDesign=document.querySelector(".trigger__design"),tabFill=document.querySelector(".trigger__fill"),tabShare=document.querySelector(".trigger__share");function closeAllTabs(){tabDesign.nextElementSibling.classList.add("hide"),tabFill.nextElementSibling.classList.add("hide"),tabShare.nextElementSibling.classList.add("hide")}function openCurrentTab(){event.currentTarget.nextElementSibling.classList.remove("hide")}function isOpen(){return!event.currentTarget.nextElementSibling.classList.contains("hide")}function openThisTab(e){isOpen(e)?e.currentTarget.nextElementSibling.classList.add("hide"):(closeAllTabs(e),openCurrentTab(e))}tabDesign.addEventListener("click",openThisTab),tabFill.addEventListener("click",openThisTab),tabShare.addEventListener("click",openThisTab);const fr=new FileReader,uploadBtn=document.querySelector(".js__profile-trigger"),fileField=document.querySelector(".js__profile-upload-btn"),profileImage=document.querySelector(".js__profile-image"),profilePreview=document.querySelector(".js__profile-preview");function getImage(e){var t=e.currentTarget.files[0];fr.addEventListener("load",writeImage),fr.readAsDataURL(t)}function writeImage(){profileImage.style.backgroundImage=`url(${fr.result})`,profilePreview.style.backgroundImage=`url(${fr.result})`,userCard.photo=fr.result,saveCache(),console.log(userCard)}function fakeFileClick(){fileField.click()}uploadBtn.addEventListener("click",fakeFileClick),fileField.addEventListener("change",getImage);const createEl=document.querySelector(".button__create"),shareTwitter=document.querySelector(".card__created");function showTwitterButton(){shareTwitter.classList.remove("hide"),createEl.classList.remove("button__create"),createEl.classList.add("button__create--clicked")}inputName.addEventListener("keyup",getCache);const btnResetEl=document.querySelector(".button__reset");function reset(){previewName.innerHTML="Nombre Apellido",previewJob.innerHTML="Front-end developer",inputName.value="",inputJob.value="",previewPhone.classList.remove("hide"),previewPhone.href="",inputPhone.value="",previewGithub.classList.remove("hide"),previewGithub.href="",inputGithub.value="",inputMail.value="";const e=document.querySelector(".buttonMail");e.classList.remove("hide"),e.href="",inputLinkedin.value="";const t=document.querySelector(".linkedin");t.classList.remove("hide"),t.href="",cardContainerEl.classList.remove("theme--grey"),cardContainerEl.classList.remove("theme--red"),cardContainerEl.classList.add("theme--green"),profileImage.style.backgroundImage="url('../../assets/images/default-avatar.jpg')",profilePreview.style.backgroundImage="url('#')",resetCache()}function fillObject(){themeGreenEl.checked?userCard.palette=parseInt(themeGreenEl.value):themeRedEl.checked?userCard.palette=parseInt(themeRedEl.value):userCard.palette=parseInt(themeGreyEl.value),console.log(userCard)}function resetCache(){localStorage.removeItem("card")}function saveCache(){const e=JSON.stringify(userCard);localStorage.setItem("card",e)}function getCache(){const e=localStorage.getItem("card"),t=JSON.parse(e);return console.log(t),t}function fillFormFromUserCard(){inputName.value=userCard.name,inputJob.value=userCard.job,inputPhone.value=userCard.phone,inputMail.value=userCard.email,inputLinkedin.value=userCard.linkedin,inputGithub.value=userCard.github,profilePreview.style.backgroundImage=`url(${userCard.photo})`,profileImage.style.backgroundImage=`url(${userCard.photo})`,parseInt(themeGreenEl.value)===userCard.palette?themeGreenEl.checked=!0:parseInt(themeRedEl.value)===userCard.palette?themeRedEl.checked=!0:parseInt(themeGreyEl.value)===userCard.palette&&(themeGreyEl.checked=!0)}function reloadPage(){const e=getCache();e&&(userCard=e,fillFormFromUserCard())}btnResetEl.addEventListener("click",reset),reloadPage();const arrowOneEl=document.querySelector(".arrow1"),subTab1Design=document.querySelector(".fieldset__theme-container"),arrowTwoEl=document.querySelector(".arrow2"),subTab2Fill=document.querySelector(".fieldset__fill-container"),arrowThreeEl=document.querySelector(".arrow3"),subTab3Share=document.querySelector(".fieldset__share-container");function interchangeArrowsDownAndUp(e){subTab1Design.classList.contains("hide")?(arrowOneEl.classList.add("fa-chevron-down"),arrowOneEl.classList.remove("fa-chevron-up")):(arrowOneEl.classList.add("fa-chevron-up"),arrowOneEl.classList.remove("fa-chevron-down")),subTab2Fill.classList.contains("hide")?(arrowTwoEl.classList.add("fa-chevron-down"),arrowTwoEl.classList.remove("fa-chevron-up")):(arrowTwoEl.classList.add("fa-chevron-up"),arrowTwoEl.classList.remove("fa-chevron-down")),subTab3Share.classList.contains("hide")?(arrowThreeEl.classList.add("fa-chevron-down"),arrowThreeEl.classList.remove("fa-chevron-up")):(arrowThreeEl.classList.add("fa-chevron-up"),arrowThreeEl.classList.remove("fa-chevron-down"))}interchangeArrowsDownAndUp();const responseURL=document.querySelector(".card__link"),responseText=document.querySelector(".form__share-subtitle"),twitterButton=document.querySelector(".share__twitter");function sendRequest(){fillObject(),fetch("https://us-central1-awesome-cards-cf6f0.cloudfunctions.net/card/",{method:"POST",body:JSON.stringify(userCard),headers:{"content-type":"application/json"}}).then(function(e){return e.json()}).then(function(e){showTwitterButton(),showURL(e)}).catch(function(e){console.log(e)})}function showURL(e){e.success?(responseText.innerHTML="La tarjeta ha sido creada",responseURL.innerHTML="<a href="+e.cardURL+">"+e.cardURL+"</a>",twitterButton.href=`https://twitter.com/intent/tweet?text=Mira%20mi%20nueva%20tarjeta%20digital:%20${e.cardURL}`,twitterButton.classList.remove("hide")):(twitterButton.classList.add("hide"),responseText.innerHTML="Ha hab√≠do un error",createEl.classList.remove("button__create--clicked"),createEl.classList.add("button__create"),responseURL.innerHTML="ERROR:"+e.error)}createEl.addEventListener("click",sendRequest),tabDesign.addEventListener("click",interchangeArrowsDownAndUp),tabFill.addEventListener("click",interchangeArrowsDownAndUp),tabShare.addEventListener("click",interchangeArrowsDownAndUp);